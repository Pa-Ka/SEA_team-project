<!DOCTYPE html>
<html ng-app="mwl.calendar.docs" lang="en">
  <head>
    <title></title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="https://unpkg.com/moment@2.17.1"></script>
    <script src="https://unpkg.com/interactjs@1"></script>
    <script src="https://unpkg.com/angular@1.6.6/angular.js"></script>
    <script src="https://unpkg.com/angular-animate@1.6.6/angular-animate.js"></script>
    <script src="https://unpkg.com/angular-ui-bootstrap@2/dist/ui-bootstrap-tpls.js"></script>
    <script src="https://unpkg.com/rrule@2"></script>
    <script src="https://unpkg.com/angular-bootstrap-colorpicker@3"></script>
    <script src="https://unpkg.com/angular-bootstrap-calendar"></script>
    <link rel="stylesheet" href="/static/assets/css/calendar.css">
    <link rel="stylesheet" href="/static/assets/css/Navigation.css">
    <link rel="stylesheet" href="/static/assets/css/rank.css">
    <link rel="stylesheet" href="/static/assets/css/todo.css">
    <link href="https://unpkg.com/bootstrap@3/dist/css/bootstrap.css" rel="stylesheet">
    <link href="https://unpkg.com/angular-bootstrap-colorpicker@3/css/colorpicker.min.css" rel="stylesheet">
    <link href="https://unpkg.com/angular-bootstrap-calendar/dist/css/angular-bootstrap-calendar.min.css" rel="stylesheet">
    <script>
    var data = JSON.parse('{{ data | tojson | safe}}');
    var cal = JSON.parse('{{ cal | tojson | safe}}');
</script>
    <script src="/static/assets/js/example.js"></script>
    <script src="/static/assets/js/helpers.js"></script>
    <script src="/static/assets/js/save_button.js"></script>
  </head>
  <body class="box-container">
    <div class="center">
        <div ng-controller="KitchenSinkCtrl as vm">
      <h2 class="text-center">{a vm.calendarTitle a}</h2>

      <div class="row" id="drag">

        <div class="col-md-6 text-center">
          <div class="btn-group">

            <button
              class="btn btn-primary"
              mwl-date-modifier
              date="vm.viewDate"
              decrement="vm.calendarView"
              ng-click="vm.cellIsOpen = false">
              Previous
            </button>
            <button
              class="btn btn-default"
              mwl-date-modifier
              date="vm.viewDate"
              set-to-today
              ng-click="vm.cellIsOpen = false">
              Today
            </button>
            <button
              class="btn btn-primary"
              mwl-date-modifier
              date="vm.viewDate"
              increment="vm.calendarView"
              ng-click="vm.cellIsOpen = false">
              Next
            </button>
          </div>
        </div>

        <br class="visible-xs visible-sm">

        <div class="col-md-6 text-center">
          <div class="btn-group">
            <label class="btn btn-primary" ng-model="vm.calendarView" uib-btn-radio="'year'" ng-click="vm.cellIsOpen = false">Year</label>
            <label class="btn btn-primary" ng-model="vm.calendarView" uib-btn-radio="'month'" ng-click="vm.cellIsOpen = false">Month</label>
            <label class="btn btn-primary" ng-model="vm.calendarView" uib-btn-radio="'week'" ng-click="vm.cellIsOpen = false">Week</label>
            <label class="btn btn-primary" ng-model="vm.calendarView" uib-btn-radio="'day'" ng-click="vm.cellIsOpen = false">Day</label>
          </div>
        </div>

      </div>

      <br>

      <mwl-calendar id="tt"
        events="vm.events"
        view="vm.calendarView"
        view-title="vm.calendarTitle"
        view-date="vm.viewDate"
        on-event-click="vm.eventClicked(calendarEvent)"
        on-event-times-changed="vm.eventTimesChanged(calendarEvent); calendarEvent.startsAt = calendarNewEventStart; calendarEvent.endsAt = calendarNewEventEnd"
        cell-is-open="vm.cellIsOpen"
        day-view-start="00:00"
        day-view-end="23:59"
        day-view-split="60"
        cell-modifier="vm.modifyCell(calendarCell)"
        cell-auto-open-disabled="true"
        on-timespan-click="vm.timespanClicked(calendarDate, calendarCell)">
      </mwl-calendar>

      <br><br><br>

      <h3 id="event-editor">
        Edit events
        <button id="add_btn"
          class="btn btn-primary pull-right"
          ng-click="vm.addEvent()"
        onclick=addnewbtn()>
          Add new
        </button>
        <div class="clearfix"></div>
      </h3>

      <table class="table table-bordered">

        <thead>
          <tr>
            <th>Title</th>
            <th>Primary color</th>
            <th>Starts at</th>
            <th>Ends at</th>
            <th>Remove</th>
            <th>Save</th>
          </tr>
        </thead>

        <tbody>
          <tr class="index_temp" ng-repeat="event in vm.events track by $index">
            <td>
              <input id = 'text_title'
                type="text"
                class="form-control"
                ng-model="event.title">
            </td>
            <td>
              <input id="prim_color" class="form-control" colorpicker type="text" ng-model="event.color.primary">
            </td>
            <td>
              <p class="input-group" style="max-width: 250px">
                <input id="starts_at"
                  type="text"
                  class="form-control"
                  readonly
                  uib-datepicker-popup="dd MMMM yyyy"
                  ng-model="event.startsAt"
                  is-open="event.startOpen"
                  close-text="Close" >
                <span class="input-group-btn">
                  <button
                    type="button"
                    class="btn btn-default"
                    ng-click="vm.toggle($event, 'startOpen', event)">
                    <i class="glyphicon glyphicon-calendar"></i>
                  </button>
                </span>
              </p>
              <div id="temp"
                uib-timepicker
                ng-model="event.startsAt"
                hour-step="1"
                minute-step="1"
                show-meridian="true">
              </div>
            </td>
            <td>
              <p class="input-group" style="max-width: 250px">
                <input id="ends_at"
                  type="text"
                  class="form-control"
                  readonly
                  uib-datepicker-popup="dd MMMM yyyy"
                  ng-model="event.endsAt"
                  is-open="event.endOpen"
                  close-text="Close">
                <span class="input-group-btn">
                  <button
                    type="button"
                    class="btn btn-default"
                    ng-click="vm.toggle($event, 'endOpen', event)">
                    <i class="glyphicon glyphicon-calendar"></i>
                  </button>
                </span>
              </p>
              <div id ="temp1"
                uib-timepicker
                ng-model="event.endsAt"
                hour-step="1"
                minute-step="1"
                show-meridian="true">
              </div>
            </td>
            <td>
              <button
                class="btn btn-danger"
                ng-click="vm.events.splice($index, 1)"
                onclick = "delete_btn()">
                Delete
                <script>
                  function delete_btn() {
                      deletedb();
                  }
                </script>
              </button>
            </td>
            <td>
              <button onclick="save()"
                class="btn btn-save">
                Save
              </button>
              <script>
                function save(){
                  alert_data(current_select)
                  $.ajax({
                    type: 'POST',
                    contentType: 'application/json',
                    url: '/',
                    data :JSON.stringify( {title : getTitle(current_select), color : getColor(current_select), startTime : starts_at(current_select), endTime : ends_at(current_select) }),
                    success : {
                    }, error : function(result){
                      console.log(result);
                    }
                  });
                }
              </script>
            </td>
          </tr>
        </tbody>
      </table>
      </div>
</div>
<div class="right-todo">
  <table>
    <caption>Today<br>TO-DO List!</caption>
    <caption><img src="/static/assets/img/icons/note.PNG" width="540px" alt="note"></caption>
    <thead>
        <tr><th>Title</th><th>Starts at</th><th>Ends at</th></tr>
    </thead>
    <tbody>
    {% for d in cal %}
    <tr><td>{{d[0]}}</td><td>{{d[2]}}</td><td>{{d[3]}}</td></tr>>
    {% endfor %}

 </table>
</div>
  </body>
<!-- jinja -->

</html>